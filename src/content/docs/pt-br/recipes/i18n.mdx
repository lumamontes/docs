---
title: Adicione funcionalidades de i18n
description: Use roteamento din√¢mico e cole√ß√µes de conte√∫do para adicionar suporte √† internacionaliza√ß√£o no seu site feito com Astro.
type: recipe
i18nReady: true
---
import FileTree from '~/components/FileTree.astro'
import StaticSsrTabs from '~/components/tabs/StaticSsrTabs.astro'

Astro n√£o tem suporte integrado a internacionaliza√ß√£o (i18n), mas voc√™ pode construir a sua pr√≥pria solu√ß√£o.
Nesta receita, voc√™ vai aprender como usar as cole√ß√µes de conte√∫do e roteamento din√¢mico para fornecer conte√∫do em diferentes idiomas.

Esse exemplo utiliza cada idioma como seu pr√≥prio subcaminho, e.x. `example.com/en/blog` para Ingl√™s e `example.com/fr/blog` para Franc√™s.

Se voc√™ prefere que o idioma padr√£o n√£o seja vis√≠vel na URL ao contr√°rio de outras idiomas, abaixo tem [instru√ß√µes para ocultar o idioma padr√£o](/pt-br/recipes/i18n/#hide-default-language-in-the-url).

## Receita

### Configure p√°ginas para cada l√≠ngua

1. Crie um diret√≥rio para cada idioma que voc√™ quer oferecer suporte. Por exemplo, `en/` e `fr/` se voc√™ estiver oferecendo suporte para ingl√™s e franc√™s:

    <FileTree>
    - src/
      - pages/
        - **en/**
          - about.astro
          - index.astro
        - **fr/**
          - about.astro
          - index.astro
        - index.astro
    </FileTree>

    
2. Configure `src/pages/index.astro` para redirecionar para o seu idioma padr√£o.

    <StaticSsrTabs>
      <Fragment slot="static">
        ```astro
        ---
        // src/pages/index.astro
        ---
        <meta http-equiv="refresh" content="0;url=/en/" />
        ```

        Esta abordagem utiliza [meta refresh](https://en.wikipedia.org/wiki/Meta_refresh) e funcionar√° independentemente de como voc√™ fizer deploy do seu site. No entanto, alguns hosts est√°ticos tamb√©m permitem que voc√™ configure redirecionamentos pelo servidor com um arquivo de configura√ß√£o personalizado. Verifique a documenta√ß√£o da sua plataforma de deploy para mais detalhes.
      </Fragment>
      
      <Fragment slot="ssr">
        Se voc√™ est√° utilizando um adaptador SSR, voc√™ pode usar [`Astro.redirect`](/en/core-concepts/routing/#dynamic-redirects) para redirecionar para a linguagem padr√£o no servidor.

        ```astro
        ---
        // src/pages/index.astro
        return Astro.redirect('/en/');
        ---
        ```
      </Fragment>
    </StaticSsrTabs>

### Use cole√ß√µes para conte√∫do traduzido

1. Crie um diret√≥rio em `src/content/` para cada tipo de conte√∫do que voc√™ quer incluir e adicione subdiret√≥rios para cada idioma suportado. Por exemplo, para oferecer suporte a postagens de blog em ingl√™s e franc√™s:

    <FileTree>
    - src/
      - content/
          - blog/
            - **en/** Postagens de blog em ingl√™s
                - post-1.md
                - post-2.md
            - **fr/** Postagens de blog em franc√™s
              - post-1.md
              - post-2.md
    </FileTree>

2. Crie um arquivo `src/content/config.ts` e exporte uma cole√ß√£o para cada tipo de conte√∫do.

    ```ts
    //src/content/config.ts
    import { defineCollection, z } from 'astro:content';

    const blogCollection = defineCollection({
      schema: z.object({
        title: z.string(),
        author: z.string(),
        date: z.date()
      })
    });

    export const collections = {
      'blog': blogCollection
    };

    ```
    üìö Leia mais sobre [Cole√ß√µes de Conte√∫do](/pt-br/guides/content-collections/).

3. Use [rotas din√¢micas](/pt-br/core-concepts/routing/#dynamic-routes) para buscar e renderizar conte√∫do baseado em par√¢metros `lang` e `slug`.

    <StaticSsrTabs>
      <Fragment slot="static">
        Em modo de renderiza√ß√£o est√°tico, use `getStaticPaths` para mapear cada entrada de conte√∫do para uma p√°gina:
        ```astro
        //src/pages/[lang]/blog/[...slug].astro
        ---
        import { getCollection } from 'astro:content'

        export async function getStaticPaths() {
          const paginas = await getCollection('blog')

          const caminhos = paginas.map(pagina => {
            const [lang, ...slug] = pagina.slug.split('/');
            return { params: { lang, slug: slug.join('/') || undefined }, props: pagina }
          })

          return caminhos;
        }

        const { lang, slug } = Astro.params;
        const pagina = Astro.props;
        const dataFormatada = pagina.data.data.toLocaleString(lang);

        const { Content } = await page.render();
        ---
        <h1>{page.data.titulo}</h1>
        <p>by {page.data.autor} ‚Ä¢ {dataFormatada}</p>
        <Content/>
        ```
      </Fragment>

      <Fragment slot="ssr">
        Em [modo SSR](/pt-br/guides/server-side-rendering/), busque a entrada solicitada diretamente:

        ```astro
        //src/pages/[lang]/blog/[...slug].astro
        ---
        import { getEntryBySlug } from 'astro:content';

        const { lang, slug } = Astro.params;
        const pagina = await getEntryBySlug('blog', `${lang}/${slug}`);

        if (!pagina) {
          return Astro.redirect('/404');
        }

        const dataFormatada = page.data.data.toLocaleString(lang);
        const { Content, headings } = await page.render();
        ---
        <h1>{page.data.titulo}</h1>
        <p>by {page.data.autor} ‚Ä¢ {dataFormatada}</p>
        <Content/>
        ```
      </Fragment>
    </StaticSsrTabs>

    üìö Leia mais sobre [roteamento din√¢mico](/pt-br/core-concepts/routing/#dynamic-routes).

    :::tip[Formata√ß√£o de data]
    O exemplo acima utiliza o m√©todo de formata√ß√£o de data [`toLocaleString()`](https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString) para criar uma string leg√≠vel a partir da data da p√°gina.
    Isso garante que a data e a hora sejam formatadas de acordo com o idioma do usu√°rio.
    :::

### Traduzir strings da UI 

Criar dicion√°rios de termos para traduzir as labels dos elementos de UI em todo o seu site. Isso permite que seus visitantes experimentem seu site completamente no idioma deles.
1. Crie um arquivo `src/i18n/ui.ts` para armazenar suas strings de tradu√ß√£o:

    ```ts
    // src/i18n/ui.ts
    export const languages = {
      en: 'English',
      fr: 'Fran√ßais',
    };

    export const defaultLang = 'en';
    
    export const ui = {
      en: {
        'nav.home': 'Home',
        'nav.about': 'About',
        'nav.twitter': 'Twitter',
      },
      fr: {
        'nav.home': 'Accueil',
        'nav.about': '√Ä propos',
      },
    } as const;
    ```
    
2. Crie duas fun√ß√µes: uma para detectar o idioma da p√°gina baseado na URL atual, e outra para obter as strings de tradu√ß√£o para diferentes partes da UI em `src/i18n/utils.ts`:

    ```js
    // src/i18n/utils.ts
    import { ui, defaultLang } from './ui';
    
    export function getLangFromUrl(url: URL) {
      const [, lang] = url.pathname.split('/');
      if (lang in ui) return lang as keyof typeof ui;
      return defaultLang;
    }
    
    export function useTranslations(lang: keyof typeof ui) {
      return function t(key: keyof typeof ui[typeof defaultLang]) {
        return ui[lang][key] || ui[defaultLang][key];
      }
    }
    ```

    :::note[Voc√™ percebeu?]
    No passo 1, a string `nav.twitter` n√£o foi traduzida para o franc√™s. Voc√™ pode n√£o querer traduzir todos os termos, como nomes pr√≥prios ou termos comuns da ind√∫stria. A fun√ß√£o `useTranslations` ir√° retornar o valor do idioma padr√£o se uma chave n√£o for traduzida. Neste exemplo, os usu√°rios franceses tamb√©m ver√£o ‚ÄúTwitter‚Äù na barra de navega√ß√£o.
    :::
    
3. Importe as fun√ß√µes onde necess√°rio e use-as para escolher a string de UI que corresponde ao idioma atual. Por exemplo, um componente de navega√ß√£o pode ser assim: 

    ```astro 
    ---
    // src/components/Nav.astro
    import { getLangFromUrl, useTranslations } from '../i18n/utils';
    
    const lang = getLangFromUrl(Astro.url);
    const t = useTranslations(lang);
    ---
    <ul>
        <li>
            <a href={`/${lang}/home/`}>
              {t('nav.home')}
            </a>
        </li>
        <li>
            <a href={`/${lang}/about/`}>
              {t('nav.about')}
            </a>
        </li>
        <li>
            <a href="https://twitter.com/astrodotbuild">
              {t('nav.twitter')}
            </a>
        </li>
    </ul>
    ```

4. Cada p√°gina deve ter um atributo `lang` no elemento `<html>` que corresponda ao idioma da p√°gina. Neste exemplo, um [layout reutiliz√°vel](/pt-br/core-concepts/layouts/) extrai o idioma da rota atual:
    ```astro
    ---
    // src/layouts/Base.astro
    
    import { getLangFromUrl } from '../i18n/utils';
    
    const lang = getLangFromUrl(Astro.url);
    ---
    <html lang={lang}>
        <head>
            <meta charset="utf-8" />
            <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
            <meta name="viewport" content="width=device-width" />
            <title>Astro</title>
        </head>
        <body>
            <slot />
        </body>
    </html>
    ```

    Assim, voc√™ pode usar este layout base para garantir que as p√°ginas usem o atributo `lang` correto automaticamente.

    ```astro
    ---
    // src/pages/en/about.astro
    import Base from "../../layouts/Base.astro"
    ---
    <Base>
        <h1>About me</h1>
        ...
    </Base>
    ```

### Permitir que os usu√°rios alternem entre idiomas

Criar links para os diferentes idiomas que voc√™ oferece suporte para que os usu√°rios possam escolher o idioma que eles querem ler seu site.

1. Crie um componente para mostrar um link para cada idioma:

    ```astro
    ---
    // src/components/LanguagePicker.astro
    import { languages } from '../i18n/ui';
    ---
    <ul>
      {Object.entries(languages).map(([lang, label]) => (
        <li>
          <a href={`/${lang}/`}>{label}</a>
        </li>
      ))}
    </ul>
    ```

2. Adicione `<LanguagePicker />` ao seu site para que ele seja mostrado em todas as p√°ginas. O exemplo abaixo adiciona ele ao rodap√© do site em um layout base:

    ```astro ins={3,17-19}
    ---
    // src/layouts/Base.astro
    import LanguagePicker from '../components/LanguagePicker.astro';
    import { getLangFromUrl } from '../i18n/utils';
    
    const lang = getLangFromUrl(Astro.url);
    ---
    <html lang={lang}>
        <head>
            <meta charset="utf-8" />
            <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
            <meta name="viewport" content="width=device-width" />
            <title>Astro</title>
        </head>
        <body>
            <slot />
            <footer>
              <LanguagePicker />
            </footer>
        </body>
    </html>
    ```

### Ocultar o idioma padr√£o na URL

1. Crie um diret√≥rio para cada idioma, exceto o idioma padr√£o. Por exemplo, armazene suas p√°ginas do idioma padr√£o diretamente em `pages/`, e suas p√°ginas traduzidas em `fr/`:

    <FileTree>
    - src/
      - pages/
        - about.astro
        - index.astro
        - **fr/**
          - about.astro
          - index.astro
    </FileTree>

2. Adicione outra linha ao arquivo `src/i18n/ui.ts` para ativar o recurso:

    ```ts
    // src/i18n/ui.ts
    export const showDefaultLang = false;
    ```


3. Adicione uma fun√ß√£o ao arquivo `src/i18n/utils.ts`, para traduzir caminhos baseado no idioma atual:
   ```js
    // src/i18n/utils.ts
    import { ui, defaultLang, showDefaultLang } from './ui';

    export function useTranslatedPath(lang: keyof typeof ui) {
      return function translatePath(path: string, l: string = lang) {
        return !showDefaultLang && l === defaultLang ? path : `/${l}${path}`
      }
    }
    ```

4. Importe a fun√ß√£o onde for necess√°rio. Por exemplo, um componente `nav` pode ficar assim:
    ```astro 
    ---
    // src/components/Nav.astro
    import { getLangFromUrl, useTranslations } from '../i18n/utils';
    
    const lang = getLangFromUrl(Astro.url);
    const t = useTranslations(lang);
    const translatePath = useTranslatedPath(lang);
    ---
    <ul>
        <li>
            <a href={translatePath('/home/')}>
              {t('nav.home')}
            </a>
        </li>
        <li>
            <a href={translatePath('/about/')}>
              {t('nav.about')}
            </a>
        </li>
        <li>
            <a href="https://twitter.com/astrodotbuild">
              {t('nav.twitter')}
            </a>
        </li>
    </ul>
    ```

5. A fun√ß√£o tamb√©m pode ser usada para traduzir caminhos para um idioma espec√≠fico. Por exemplo, quando os usu√°rios alternam entre idiomas:
    ```astro
    ---
    // src/components/LanguagePicker.astro
    import { languages } from '../i18n/ui';
    ---

    <ul>
      {Object.entries(languages).map(([lang, label]) => (
        <li>
          <a href={translatePath('/', lang)}>{label}</a>
        </li>
      ))}
    </ul>
    ```

### Traduzir rotas

Traduzir as rotas das suas p√°ginas para cada idioma.

1. Adicione mapeamento de rotas no arquivo `src/i18n/ui.ts`:

 ```ts
 // src/i18n/ui.ts
 export const rotas = {
   de: {
    'services': 'leistungen',
   },
   fr: {
    'services': 'prestations-de-service',
   },
  }
    ```

2. Atualize a fun√ß√£o `useTranslatedPath` no arquivo `src/i18n/utils.ts` para adicionar a l√≥gica de tradu√ß√£o de roteamento.
  ```js
  // src/i18n/utils.ts
  import { ui, linguaPadrao, mostrarLinguaPadrao, rotas } from './ui';

  export function usarCaminhoTraduzido(lang: keyof typeof ui) {
    return function traduzirCaminho(caminho: string, l: string = lang) {
      const nomeCaminho = caminho.replaceAll('/', '')
      const temTraducao = linguaPadrao !== l && rotas[l] !== undefined && rotas[l][nomeCaminho] !== undefined
      const caminhoTraduzido = temTraducao ? '/' + rotas[l][nomeCaminho] : path

      return !mostrarCaminhoTraduzido && l === linguaPadrao ? caminhoTraduzido : `/${l}${caminhoTraduzido}`
    }
  }
  ```

3. Crie uma fun√ß√£o auxiliar para obter a rota, se ela existir baseada na URL atual, em `src/i18n/utils.ts`:
  ```js
  // src/i18n/utils.ts
  import { ui, defaultLang, showDefaultLang, routes } from './ui';
  
  export function getRouteFromUrl(url: URL): string | undefined {
    const pathname = new URL(url).pathname
    const parts = pathname?.split('/')
    const path = parts.pop() || parts.pop()
  
    if (path === undefined) {
      return undefined
    }
    
    const currentLang = getLangFromUrl(url);
  
    if (defaultLang === currentLang) {
      const route = Object.values(routes)[0];
      return route[path] !== undefined ? route[path] : undefined
    }
    
    const getKeyByValue = (obj: Record<string, string>, value: string): string | undefined  => {
        return Object.keys(obj).find((key) => obj[key] === value)
    }
  
    const reversedKey = getKeyByValue(routes[currentLang], path)
  
    if (reversedKey !== undefined) {
      return reversedKey
    }
  
    return undefined
  }
  ```

4. A fun√ß√£o auxiliar pode ser usada para obter uma rota traduzida. Por exemplo, quando nenhuma rota traduzida √© definida, o usu√°rio ser√° redirecionado para sua p√°gina inicial:
 ```astro
    ---
    // src/components/LanguagePicker.astro
    import { languages } from '../i18n/ui';
    const route = getRouteFromUrl(Astro.url);
    ---

    <ul>
      {Object.entries(languages).map(([lang, label]) => (
        <li>
          <a href={translatePath(`/${route ? route : ''}`, lang)}>{label}</a>
        </li>
      ))}
    </ul>
    ```

## Recursos
- [Choosing a Language Tag](https://www.w3.org/International/questions/qa-choosing-language-tags)
- [Right-to-left Styling 101](https://rtlstyling.com/)

## Bibliotecas da comunidade
- [astro-i18next](https://github.com/yassinedoghri/astro-i18next) ‚Äî An Astro integration for i18next including some utility components.
- [astro-i18n](https://github.com/alexandre-fernandez/astro-i18n) ‚Äî A TypeScript-first internationalization library for Astro.
- [astro-i18n-aut](https://github.com/jlarmstrongiv/astro-i18n-aut) ‚Äî An Astro integration for i18n that supports the `defaultLocale` without page generation. The integration is adapter agnostic and UI framework agnostic.
